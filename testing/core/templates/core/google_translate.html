<!-- Google Translate Widget -->
<div id="google_translate_element" style="display:none;"></div>
<script type="text/javascript">
function googleTranslateElementInit() {
  new google.translate.TranslateElement(
    {
      pageLanguage: 'en',  // default site language
      includedLanguages: 'en,hi,bn,ta,te,mr,gu,kn,ml,pa,or,as,ur',  // supported languages
      layout: google.translate.TranslateElement.InlineLayout.SIMPLE
    },
    'google_translate_element'
  );
}
</script>
<script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<script>
document.addEventListener("DOMContentLoaded", function () {
    const userLang = "{{ user_language }}";  // from context processor
    if (userLang && userLang !== "en") {
        const interval = setInterval(() => {
            const select = document.querySelector("select.goog-te-combo");
            if (select) {
                select.value = userLang;
                select.dispatchEvent(new Event("change"));
                clearInterval(interval);
            }
        }, 500); // retry every 0.5s until loaded
    }
});
</script>
