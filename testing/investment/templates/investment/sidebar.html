<!-- finance/sidebar.html -->
 {% load static %}
<link rel="stylesheet" href="{% static 'finance/sidebar.css' %}">
<canvas id="money-bg"></canvas>
<div class="sidebar" id="sidebar">
    <a href="{% url 'investment_list' %}" class="{% if request.resolver_match.url_name == 'investment_list' %}active{% endif %}" data-tooltip="Investment List">
      <span>üìã</span><span class="label">Investment List</span>
    </a>

    <a href="{% url 'add_investment' %}" class="{% if request.resolver_match.url_name == 'add_investment' %}active{% endif %}" data-tooltip="Add Investment">
      <span>üí∞</span><span class="label">Add Investment</span>
    </a>

    <a href="{% url 'investment_portfolio' %}" class="{% if request.resolver_match.url_name == 'investment_portfolio' %}active{% endif %}" data-tooltip="Investment Portfolio">
      <span>üìä</span><span class="label">Investment Portfolio</span>
    </a>

    {% comment %} <a href="{% url 'manage_auto_savings' %}" class="{% if request.resolver_match.url_name == 'manage_auto_savings' %}active{% endif %}" data-tooltip="Auto-Savings">
      <span>‚öôÔ∏è</span><span class="label">Auto-Savings</span>
    </a> {% endcomment %}
</div>



<script>
    // Auto-hide popup messages
    setTimeout(() => {
        document.querySelectorAll(".popup-message").forEach(msg => {
            msg.classList.add("fade-out");
            setTimeout(() => msg.remove(), 500);
        });
    }, 8000);

    // Sidebar toggle
    const sidebar = document.getElementById('sidebar');
    const toggleBtn = document.getElementById('toggleBtn');

    toggleBtn.addEventListener('click', () => {
      sidebar.classList.toggle('collapsed');
    });
</script>
<script>
const canvas = document.getElementById('money-bg');
if (canvas) {
  const ctx = canvas.getContext('2d');

  function resize() {
    canvas.width = innerWidth * devicePixelRatio;
    canvas.height = innerHeight * devicePixelRatio;
    ctx.setTransform(devicePixelRatio, 0, 0, devicePixelRatio, 0, 0);
  }
  window.addEventListener('resize', resize);
  resize();

  class Bill {
    constructor() { this.reset(); }
    reset() {
      this.x = Math.random() * innerWidth;
      this.y = Math.random() * innerHeight;
      const speed = 0.02 + Math.random() * 0.05; // üê¢ Very slow floating
      const angle = Math.random() * Math.PI * 2;
      this.vx = Math.cos(angle) * speed;
      this.vy = Math.sin(angle) * speed;
      this.size = 60 + Math.random() * 100;
      this.rotation = Math.random() * Math.PI * 2;
      this.spin = (Math.random() * 2 - 1) * 0.003; // slow spin
      this.opacity = 0.7 + Math.random() * 0.3;
      this.life = 0;
      this.maxLife = 1000 + Math.random() * 800;

      // --- Indian ‚Çπ100 (lavender), ‚Çπ200 (orange), ‚Çπ500 (grey-green) palette ---
      const colors = [
        "#9ddba7ff", // ‚Çπ100 lavender
        "#67c15bff", // deep ‚Çπ100 shade
        "#FFA726", // ‚Çπ200 orange
        "#F57C00", // deep ‚Çπ200 orange
        "#A0B39C", // ‚Çπ500 grey-green
        "#8D9E8A"  // deep ‚Çπ500 tone
      ];
      this.color = colors[Math.floor(Math.random() * colors.length)];
    }
    update() {
      this.x += this.vx;
      this.y += this.vy;
      this.rotation += this.spin;
      this.life++;

      if (this.x < -200 || this.x > innerWidth + 200 || this.y < -200 || this.y > innerHeight + 200)
        this.reset();
    }
    draw() {
      ctx.save();
      ctx.globalAlpha = this.opacity;
      ctx.translate(this.x, this.y);
      ctx.rotate(this.rotation);
      const w = this.size;
      const h = this.size * 0.55;
      ctx.fillStyle = this.color;
      ctx.strokeStyle = "#155d27";
      ctx.lineWidth = 2;
      ctx.beginPath();
      ctx.roundRect(-w / 2, -h / 2, w, h, 10);
      ctx.fill();
      ctx.stroke();
      ctx.fillStyle = "#0c2b0a";
      ctx.font = `${Math.round(h * 0.6)}px serif`;
      ctx.textAlign = "center";
      ctx.textBaseline = "middle";
      ctx.fillText("‚Çπ", 0, 0);
      ctx.restore();
    }
  }

  if (!CanvasRenderingContext2D.prototype.roundRect) {
    CanvasRenderingContext2D.prototype.roundRect = function (x, y, w, h, r) {
      if (typeof r === 'number') r = { tl: r, tr: r, br: r, bl: r };
      this.beginPath();
      this.moveTo(x + r.tl, y);
      this.arcTo(x + w, y, x + w, y + h, r.tr);
      this.arcTo(x + w, y + h, x, y + h, r.br);
      this.arcTo(x, y + h, x, y, r.bl);
      this.arcTo(x, y, x + w, y, r.tl);
      this.closePath();
      return this;
    }
  }

  const bills = Array.from({ length: 30 }, () => new Bill());

  function loop() {
    const isDark = document.body.classList.contains("dark");
    ctx.fillStyle = isDark ? "#000" : "#fff";
    ctx.fillRect(0, 0, innerWidth, innerHeight);

    for (const b of bills) {
      b.update();
      b.draw();
    }

    requestAnimationFrame(loop);
  }
  loop();
}
</script>

